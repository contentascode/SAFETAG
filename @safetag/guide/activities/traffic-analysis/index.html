<!DOCTYPE html><!--if lt IE 7<html class="ie ie6" lang="en">--><!--if IE 7<html class="ie ie7" lang="en">--><!--if IE 8<html class="ie ie8" lang="en">--><!--if (gte IE 9)|!(IE)<!--><html lang="en"> <!--
--><html><head><meta charset="utf8"><title> &middot; SAFETAG</title><meta name="description" content=""><meta name="author" content=""><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><link href="/safetag/@safetag/guide/filter.js/assets/css/bootstrap.min.css" media="screen" rel="stylesheet" type="text/css"><link href="/safetag/@safetag/guide/filter.js/assets/css/jquery-ui-1.10.2.custom.min.css" media="screen" rel="stylesheet" type="text/css"><link href="/safetag/@safetag/guide/filter.js/assets/css/stream.css" media="screen" rel="stylesheet" type="text/css"><link rel="stylesheet" href="/safetag/@safetag/guide/css/skeleton.css"><link rel="stylesheet" href="/safetag/@safetag/guide/css/selection.css"><link rel="stylesheet" href="/safetag/@safetag/guide/css/site.css"><link rel="stylesheet" href="/safetag/@safetag/guide/css/fonts.css"><script src="/safetag/@safetag/guide/filter.js/assets/js/jquery-1.11.3.min.js" type="text/javascript"></script><script src="/safetag/@safetag/guide/filter.js/assets/js/jquery-ui-1.10.2.custom.min.js" type="text/javascript"></script><script src="/safetag/@safetag/guide/filter.js/assets/js/jquery-ui-1.10.2.custom.min.js" type="text/javascript"></script><script src="/safetag/@safetag/guide/js/js-yaml.min.js"></script><script src="/safetag/@safetag/guide/js/sortable.min.js"></script><script src="/safetag/@safetag/guide/js/lodash.min.js"></script><script src="/safetag/@safetag/guide/js/filter.js"></script><script src="/safetag/@safetag/guide/js/anchor.min.js"></script><script src="/safetag/@safetag/guide/js/site.js"></script><link rel="shortcut icon" href="/safetag/@safetag/guide/img/favicon.ico"><link rel="apple-touch-icon" href="/safetag/@safetag/guide/img/apple-touch-icon.png"><link rel="apple-touch-icon" sizes="72x72" href="/safetag/@safetag/guide/img/apple-touch-icon-72x72.png"><link rel="apple-touch-icon" sizes="114x114" href="/safetag/@safetag/guide/img/apple-touch-icon-114x114.png"><link rel="alternate" type="application/rss+xml" title="RSS" href="/safetag/@safetag/guide/atom.xml"></head><div class="navbar-spacer"></div><nav class="navbar navbar-fixed-top"><div class="container"><ul class="navbar-list"><li class="navbar-item"><a class="navbar-link" href="/safetag/@safetag/guide/">Home</a></li><li class="navbar-item"><a class="navbar-link" href="#" data-popover="#codeNavAbout">Methods</a><div class="popover" id="codeNavAbout"><ul class="popover-list"><li class="popover-item"><a class="popover-link" href="/safetag/@safetag/guide/methods/preparation.guide">Preparation</a></li><li class="popover-item"><a class="popover-link" href="/safetag/@safetag/guide/methods/context_research.guide">Context Research</a></li><li class="popover-item"><a class="popover-link" href="/safetag/@safetag/guide/methods/capacity_assessment.guide">Capacity Assessment</a></li><li class="popover-item"><a class="popover-link" href="/safetag/@safetag/guide/methods/reconnaissance.guide">Reconnaissance</a></li><li class="popover-item"><a class="popover-link" href="/safetag/@safetag/guide/methods/network_discovery.guide">Network Discovery</a></li><li class="popover-item"><a class="popover-link" href="/safetag/@safetag/guide/methods/network_access.guide">Network Access</a></li><li class="popover-item"><a class="popover-link" href="/safetag/@safetag/guide/methods/network_mapping.guide">Network Mapping</a></li><li class="popover-item"><a class="popover-link" href="/safetag/@safetag/guide/methods/user_device_assessment.guide">User Device Assessment</a></li><li class="popover-item"><a class="popover-link" href="/safetag/@safetag/guide/methods/vulnerability_scanning.guide">Vulnerability Scanning and Assessment</a></li><li class="popover-item"><a class="popover-link" href="/safetag/@safetag/guide/methods/data_assessment.guide">Data Asssessment</a></li><li class="popover-item"><a class="popover-link" href="/safetag/@safetag/guide/methods/physical_assessment.guide">Physical Assessment</a></li><li class="popover-item"><a class="popover-link" href="/safetag/@safetag/guide/methods/risk_modeling.guide">Process Mapping and Risk Modeling</a></li><li class="popover-item"><a class="popover-link" href="/safetag/@safetag/guide/methods/threat_assessment.guide">Threat Assessment</a></li><li class="popover-item"><a class="popover-link" href="/safetag/@safetag/guide/methods/responsive_support.guide">Responsive Support</a></li><li class="popover-item"><a class="popover-link" href="/safetag/@safetag/guide/methods/follow_up.guide">Follow Up</a></li></ul></div></li><li class="navbar-item u-pull-right hidden" id="cd-cart-trigger"><a class="navbar-link cd-img-replace cd-cart" href="#0">Plan<i class="glyphicon glyphicon-list-alt"><span>0</span></i></a></li></ul></div></nav><body class="has-docked-nav" data-baseurl="/safetag/@safetag/guide"><div class="container"><div class="row links"><small><div class="crumb u-pull-left"><a href="/safetag/@safetag/guide">Home</a> / Activities  / Traffic Analysis</div><div class="utilities u-pull-right"><a href="https://github.com/SAFETAG/SAFETAG/edit/master/en/exercises/traffic_analysis/summary.md">Edit</a> - <a href="https://github.com/SAFETAG/SAFETAG/commits/master/en/exercises/traffic_analysis/summary.md">Changes</a> - <a href="https://github.com/SAFETAG/SAFETAG/blob/master/en/exercises/traffic_analysis/summary.md">Source</a></div></small></div><div class="docs-section"><div class="space"> </div><h1 id="network-traffic-analysis">Network Traffic Analysis</h1>
<h2 id="summary">Summary</h2>
<p>Any content that is sent out over the network without encryption is easy to intercept; this includes email, web passwords, and chat messages.</p>
<p>This attacker could be someone, such as a patron of the Internet cafe where a staff member is working, who just happens to be using the same local network to connect to the Internet. Or, she could work for an organization with privileged access to the relevant network, such as the Internet Service Provider (ISP) of either the sender or receiver and other network-backbone connections made along the way.</p>
<h2 id="materials-needed">Materials Needed</h2>
<ul>
<li>Wifi device and drivers supporting &quot;promiscuous mode&quot; (see <a href="http://www.aircrack-ng.org/doku.php?id=compatible_cards&amp;DokuWiki=a36042531edb54f9b95a76ff61d77d14" class="uri">http://www.aircrack-ng.org/doku.php?id=compatible_cards&amp;DokuWiki=a36042531edb54f9b95a76ff61d77d14</a>)</li>
</ul>
<h2 id="operational-security">Operational Security</h2>
<ul>
<li>Treat captured network traffic with the utmost security and empathetic<br />
responsibility. They may contain very personal data, passwords, and more. These<br />
should not be shared except in specific, intentional samples with anyone, including<br />
the organization itself.</li>
</ul>
<h2 id="walkthrough">Walkthrough</h2>
<h5 id="network-traffic-interception">Network Traffic Interception</h5>
<p><strong>Step 1:</strong> The attacker tricks the victim into routing all of their traffic through the attacker’s machine. This involves making a simple request to the victim’s IP address, which is not difficult to do. Computers are rarely configured to ignore such requests.</p>
<pre><code>$ sudo sh -c &#39;echo 1 &gt; /proc/sys/net/ipv4/ip_forward&#39;

$ sudo arpspoof -i wlan0 -t 192.168.1.99 192.168.1.1</code></pre>
<p>Sample Output:</p>
<pre><code>00:11:22:33:44:55 aa:bb:cc:dd:ee:ff 0806 42: arp reply 192.168.1.1 is-at 00:11:22:33:44:55
00:11:22:33:44:55 aa:bb:cc:dd:ee:ff 0806 42: arp reply 192.168.1.1 is-at 00:11:22:33:44:55
00:11:22:33:44:55 aa:bb:cc:dd:ee:ff 0806 42: arp reply 192.168.1.1 is-at 00:11:22:33:44:55
00:11:22:33:44:55 aa:bb:cc:dd:ee:ff 0806 42: arp reply 192.168.1.1 is-at 00:11:22:33:44:55
...
00:11:22:33:44:55 aa:bb:cc:dd:ee:ff 0806 42: arp reply 192.168.1.1 is-at 00:11:22:33:44:55</code></pre>
<p>In the example above, only a single victim (192.168.1.99) is being targeted, but the attack works fine against multiple victims, or even against the entire network. In other words, the attacker does not need to know which IP address (on the office or Internet cafe LAN, for example) belongs to the target. Furthermore, the victim is extremely unlikely to notice any sign that this phase of the attack is taking place.</p>
<p>EtterCap provides a powerful frontend to managing this process with multiple potential targets. In EtterCap:</p>
<ul>
<li>Under the &quot;Sniff&quot; menu, select &quot;Unified sniffing&quot; (for most cases where you are using one interface to both intercept and forward traffic), and select the relevant interface (wlan0)</li>
<li>Under the Hosts menu, select the systems on the network you will target, or leave blank to target all systems</li>
<li>Under Mitm, select &quot;arp spoofing&quot; for this example</li>
<li>Select &quot;Start&quot; under the Sniffing menu</li>
</ul>
<!-- Ettercap Screenshot -->
<p><strong>Step 2:</strong> At this point, if the attacker is looking for unencrypted traffic, all the attacker needs to do is launch a packet-sniffer, such as Wireshark, and scan through the intercepted traffic for specific vulnerable information, such as email or website logins, as well as traffic revealing shadow infrastructure usage, such as Dropbox.</p>
<p>Wireshark can also be used to identify malicious traffic.</p>
<p>If you rarely use Wireshark, the output you will see will be a long list of packets, protocols and connections that might be hard to classify. To look into suspicious processes in a clearer way, you can use the &quot;Protocol Hierarchy&quot; option in the Statistics menu A good video to learn how to use this option for this purpose can be found <a href="https://www.youtube.com/watch?v=OwQmwbD1uIs">here</a>.</p>
<ul>
<li>If you want to practice with captures of malicious traffic, you can find them in the <a href="https://wiki.wireshark.org/SampleCaptures">Wireshark wiki</a>.</li>
</ul>
<!-- Wireshark screenshot -->
<h2 id="recommendation">Recommendation</h2>
<p>Only use services with <a href="https://securityinabox.org/en/guide/secure-communication">&quot;SSL&quot; encryption</a> (&quot;HTTPS&quot;), and consider adding <a href="https://www.eff.org/https-everywhere">HTTPS Everywhere</a> to browsers. This does not itself guarantee protection from all attacks, but it is a good first-step in protecting information (such as passwords or email) in transit from your computer to the service provider.</p>
</div></div></body><div class="section categories"><div class="container"><div class="row"><div class="two columns">&nbsp;</div><div class="eight column category"><h4>Developed with ❤ by</h4><a href="https://iilab.org"><img class="u-max-full-width" src="/safetag/@safetag/guide/img/iilab_white.svg"></a><h5>Information Innovation Lab</h5><p>Applied research and development of public interest technology.</p></div><div class="two columns">&nbsp;</div></div></div></div><script>$( document ).ready(function() {
  anchors.options.placement = 'left';
  anchors.add('h1,h2,h3');
})
</script></html>