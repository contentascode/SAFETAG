<!DOCTYPE html><!--if lt IE 7<html class="ie ie6" lang="en">--><!--if IE 7<html class="ie ie7" lang="en">--><!--if IE 8<html class="ie ie8" lang="en">--><!--if (gte IE 9)|!(IE)<!--><html lang="en"> <!--
--><html><head><meta charset="utf8"><title> &middot; SAFETAG</title><meta name="description" content=""><meta name="author" content=""><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><link href="/safetag/@safetag/guide/filter.js/assets/css/bootstrap.min.css" media="screen" rel="stylesheet" type="text/css"><link href="/safetag/@safetag/guide/filter.js/assets/css/jquery-ui-1.10.2.custom.min.css" media="screen" rel="stylesheet" type="text/css"><link href="/safetag/@safetag/guide/filter.js/assets/css/stream.css" media="screen" rel="stylesheet" type="text/css"><link rel="stylesheet" href="/safetag/@safetag/guide/css/skeleton.css"><link rel="stylesheet" href="/safetag/@safetag/guide/css/selection.css"><link rel="stylesheet" href="/safetag/@safetag/guide/css/site.css"><link rel="stylesheet" href="/safetag/@safetag/guide/css/fonts.css"><script src="/safetag/@safetag/guide/filter.js/assets/js/jquery-1.11.3.min.js" type="text/javascript"></script><script src="/safetag/@safetag/guide/filter.js/assets/js/jquery-ui-1.10.2.custom.min.js" type="text/javascript"></script><script src="/safetag/@safetag/guide/filter.js/assets/js/jquery-ui-1.10.2.custom.min.js" type="text/javascript"></script><script src="/safetag/@safetag/guide/js/js-yaml.min.js"></script><script src="/safetag/@safetag/guide/js/sortable.min.js"></script><script src="/safetag/@safetag/guide/js/lodash.min.js"></script><script src="/safetag/@safetag/guide/js/filter.js"></script><script src="/safetag/@safetag/guide/js/anchor.min.js"></script><script src="/safetag/@safetag/guide/js/site.js"></script><link rel="shortcut icon" href="/safetag/@safetag/guide/img/favicon.ico"><link rel="apple-touch-icon" href="/safetag/@safetag/guide/img/apple-touch-icon.png"><link rel="apple-touch-icon" sizes="72x72" href="/safetag/@safetag/guide/img/apple-touch-icon-72x72.png"><link rel="apple-touch-icon" sizes="114x114" href="/safetag/@safetag/guide/img/apple-touch-icon-114x114.png"><link rel="alternate" type="application/rss+xml" title="RSS" href="/safetag/@safetag/guide/atom.xml"></head><div class="navbar-spacer"></div><nav class="navbar navbar-fixed-top"><div class="container"><ul class="navbar-list"><li class="navbar-item"><a class="navbar-link" href="/safetag/@safetag/guide/">Home</a></li><li class="navbar-item"><a class="navbar-link" href="#" data-popover="#codeNavAbout">Methods</a><div class="popover" id="codeNavAbout"><ul class="popover-list"><li class="popover-item"><a class="popover-link" href="/safetag/@safetag/guide/methods/preparation.guide">Preparation</a></li><li class="popover-item"><a class="popover-link" href="/safetag/@safetag/guide/methods/context_research.guide">Context Research</a></li><li class="popover-item"><a class="popover-link" href="/safetag/@safetag/guide/methods/capacity_assessment.guide">Capacity Assessment</a></li><li class="popover-item"><a class="popover-link" href="/safetag/@safetag/guide/methods/reconnaissance.guide">Reconnaissance</a></li><li class="popover-item"><a class="popover-link" href="/safetag/@safetag/guide/methods/network_discovery.guide">Network Discovery</a></li><li class="popover-item"><a class="popover-link" href="/safetag/@safetag/guide/methods/network_access.guide">Network Access</a></li><li class="popover-item"><a class="popover-link" href="/safetag/@safetag/guide/methods/network_mapping.guide">Network Mapping</a></li><li class="popover-item"><a class="popover-link" href="/safetag/@safetag/guide/methods/user_device_assessment.guide">User Device Assessment</a></li><li class="popover-item"><a class="popover-link" href="/safetag/@safetag/guide/methods/vulnerability_scanning.guide">Vulnerability Scanning and Assessment</a></li><li class="popover-item"><a class="popover-link" href="/safetag/@safetag/guide/methods/data_assessment.guide">Data Asssessment</a></li><li class="popover-item"><a class="popover-link" href="/safetag/@safetag/guide/methods/physical_assessment.guide">Physical Assessment</a></li><li class="popover-item"><a class="popover-link" href="/safetag/@safetag/guide/methods/risk_modeling.guide">Process Mapping and Risk Modeling</a></li><li class="popover-item"><a class="popover-link" href="/safetag/@safetag/guide/methods/threat_assessment.guide">Threat Assessment</a></li><li class="popover-item"><a class="popover-link" href="/safetag/@safetag/guide/methods/responsive_support.guide">Responsive Support</a></li><li class="popover-item"><a class="popover-link" href="/safetag/@safetag/guide/methods/follow_up.guide">Follow Up</a></li></ul></div></li><li class="navbar-item u-pull-right hidden" id="cd-cart-trigger"><a class="navbar-link cd-img-replace cd-cart" href="#0">Plan<i class="glyphicon glyphicon-list-alt"><span>0</span></i></a></li></ul></div></nav><body class="has-docked-nav" data-baseurl="/safetag/@safetag/guide"><div class="container"><div class="row links"><small><div class="crumb u-pull-left"><a href="/safetag/@safetag/guide">Home</a> / Activities  / Evidence Capture</div><div class="utilities u-pull-right"><a href="https://github.com/SAFETAG/SAFETAG/edit/master/en/exercises/evidence_capture/variant_offline_capture.md">Edit</a> - <a href="https://github.com/SAFETAG/SAFETAG/commits/master/en/exercises/evidence_capture/variant_offline_capture.md">Changes</a> - <a href="https://github.com/SAFETAG/SAFETAG/blob/master/en/exercises/evidence_capture/variant_offline_capture.md">Source</a></div></small></div><div class="docs-section"><div class="space"> </div><h1 id="digital-forensics-and-evidence-capture">Digital Forensics and Evidence Capture</h1>
<h2 id="summary">Summary</h2>
<p>This component briefs the tools and procedures required to acquire the image (live or dead, depending on the situation) and securely handle data from a device (laptop, desktop, HDD, memory stick, USB stick, etc.) that is needed to later perform a malware analysis or forensic evidence process.</p>
<h2 id="materials-needed">Materials Needed</h2>
<p><strong>Skills Needed</strong></p>
<ul>
<li>Use of evidence capture tools (below) to capture memory dumps and to byte-copy the data in order to create a forensic image to be used to execute tests without affecting the original evidence received.</li>
</ul>
<p><strong>Required software</strong> - depending on the data acquisition type and the operating system, you will need the following tools:</p>
<ul>
<li>Live imaging:</li>
<li>Windows: DumpIt</li>
<li>Mac OS: OSXpmem</li>
<li>Linux: LiME - Linux Memory Extractor</li>
<li>Dead imaging:</li>
<li>DEFT distro</li>
</ul>
<p><strong>Additional materials</strong></p>
<ul>
<li>Labels or tags</li>
<li>anti-static bags</li>
<li>equally sized or larger hard drive or storage device to store the image</li>
<li>USB stick to collect a file log</li>
</ul>
<h2 id="operational-security">Operational Security</h2>
<ul>
<li>Define how to handle the documentation and containment related to the data acquisition.</li>
<li>Follow the data forensic analysis procedures that are required to ensure the evidence is properly handled (see &quot;Important notes on capturing evidence for analysis&quot; below).</li>
<li>Document all the process and keep a log, including timestamps, dates, and time zones, as well as versions of software and operating system.</li>
<li>Carefully consider how to protect this data in transit to analysis. See &quot;How to handle forensic data&quot; below for notes on the Chain of Custody.</li>
<li>While byte-copying data, be extremely careful when typing the command line <code>dd</code> or related. Reversing the <strong><code>if</code></strong> and <strong><code>of</code></strong> flags, or confusing the label of the device block related to the source or destination device <strong>will cause the computer to destroy the evidence!</strong></li>
<li>If possible, always connect the source disk with a write blocker to prevent modification of the evidence.</li>
</ul>
<h2 id="walkthrough">Walkthrough</h2>
<p><strong>The Chain of Custody: How to handle forensic data</strong></p>
<p>The Chain of Custody (often referred to as audit trail or chain of evidence) is the process of preserving the integrity of the digital evidence. Being able to maintain the Chain of Custody is very important for forensic evidence. This means that you need to record, and be able to prove, that authorized personnel were in control of the evidence at all times, and that no unauthorized person or device or mechanism could have altered the evidence while in our custody.</p>
<p>To maintain the Chain of Custody, it is imperative to carefully document what happens to the evidence. This means:</p>
<ul>
<li><p><strong>Store the evidence in an anti-static bag</strong>, or similar appropriate container that will protect the device from static electricity or other destructive forces.</p></li>
<li><p><strong>Clearly label the evidence.</strong> There must be no confusion about a piece of evidence. All evidence, whether hard drives, USB sticks, DVDs, etc. should be clearly labeled with the following information:</p></li>
<li>What the evidence relates to</li>
<li>Who received the evidence</li>
<li>Location of where the evidence was received</li>
<li>Location of where the evidence was sourced from</li>
<li>The date and time the evidence came into our possession</li>
<li><p>Any other notes you think are relevant regarding this piece of evidence (the specifications of the computer a hard drive came from, etc.)</p></li>
<li><p>Every time the evidence changes hands, <strong>the next person responsible for the evidence should &quot;sign for it&quot;</strong>, which means documentation should be produced where the recipient of the evidence confirms they have received the evidence into their custody with their signature.</p></li>
<li><strong>Deny unauthorized personnel from accessing the data</strong> - Every reasonable effort must be taken to prevent unauthorized access to the stored evidence. This means:</li>
<li>Storing the evidence in a locked safe</li>
<li>Controlling access to areas where the evidence is stored and analyzed</li>
<li><p>Not leaving unauthorized people alone with the evidence</p></li>
<li><p><strong>If you have to send evidence via courier, or the postal service</strong>:</p></li>
<li>Special containers should be used to seal the evidence in such a way that the container cannot be opened without it being apparent (e.g. seal with special tape that, if removed, cannot be replaced without showing that the container has been opened).</li>
<li><p>Make a copy (image) of the evidence before sending the original through the post or courier service, and generate a hash of the image.</p></li>
</ul>
<p><strong>Live or Dead Imaging?</strong></p>
<p>Different processes and tools are used depending on what kind of data acquisition and investigation will be done. However, in order to make a correct decision on how to get the forensic image, you should take into account the following questions:</p>
<ul>
<li>Is the computer networked? The data in a networked device could be remotely erased. That's why this question is relevant and time sensitive.</li>
<li>Is the computer running? Important volatile information could be lost if the computer is turned off.</li>
<li>Do you want to preserve volatile data? Nowadays, sophisticated malware hides on volatile data and modern web browsers can operate in ‘incognito’ or ‘private’ mode (no information is saved). In most of these cases, preserving live evidence is the only way to go, so deleting it may cause loss of evidence. Therefore this decision should be taken in advance, based on the details gathered before the data acquisition.</li>
<li>Is full-disk encryption enabled? An encrypted disk could complicate the investigation. If the disk is encrypted, the investigator should ask for the password and decrypt the disk manually.</li>
<li>Is the console unlocked? if the console is locked, a live CD should be used.</li>
</ul>
<p>Regarding the definitions, we call 'dead imaging', or 'offline imaging', the process of obtaining evidence from systems that are switched off and where no data processing is taking place, while 'live imaging', or 'memory imaging', refers to the process of making a bit-by-bit copy of memory in order to preserve the volatile data available in the device. There is a lot of information of evidentiary value that could be found in a live system. Switching it off may cause loss of volatile data such as running processes, network connections and mounted file systems. On the other hand, leaving a computer running may cause evidence to be altered or deleted. Therefore the investigator needs to decide what alternative is best in each given situation. Another approach is to use specialized tools to extract volatile data from the computer before shutting it down.</p>
<hr />
<h5 id="variant-live-imaging-tools-and-procedures">Variant: Live imaging tools and procedures</h5>
<p>:<a href="variant_live_capture.md"></a></p>
<hr />
<h5 id="variant-offline-dead-imaging-tools-and-procedures">Variant: Offline / Dead imaging tools and procedures</h5>
<p>:<a href="variant_offline_capture.md"></a></p>
<h2 id="recommendation">Recommendation</h2>
<p>See Incident Response guidance.</p>
</div></div></body><div class="section categories"><div class="container"><div class="row"><div class="two columns">&nbsp;</div><div class="eight column category"><h4>Developed with ❤ by</h4><a href="https://iilab.org"><img class="u-max-full-width" src="/safetag/@safetag/guide/img/iilab_white.svg"></a><h5>Information Innovation Lab</h5><p>Applied research and development of public interest technology.</p></div><div class="two columns">&nbsp;</div></div></div></div><script>$( document ).ready(function() {
  anchors.options.placement = 'left';
  anchors.add('h1,h2,h3');
})
</script></html>